---
title: "Assignment 14"
author: "Eric Zhou"
date: "2023-03-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# **Apprentice**

## Problem 1

```{r}
ds <- c(1.8, 2.0, 1.6, 2.3, 2.2, 1.9, 1.5, 2.1, 1.9, 2.2)
```

#### **Part a**: $H_0:\mu=1.8, H_A:\mu\neq1.8$

#### **Part b**: Standard error is about 0.08. The null distribution is a t-distribution because we don't know the population standard deviation so we estimate using the sample standard deviation. The degree of freedom is 10 - 1 = 9.

```{r}
se <- sd(ds)/sqrt(10)
se
```

#### **Part c**:

```{r}
x <- seq(-2.5, 2.5, 0.01)
plot(x, dt(x, df=9), type="l", col="blue", ylab="Probability")
abline(v=qt(0.025, 9), col="red")
abline(v=qt(0.975, 9), col="red")
```

#### **Part d**: Value of t is 1.8, exactly equal to $\mu$. This shows that it is pretty likely that the sample fits well with the true mean unless the standard error is very high. In this case, the t-value is within the critical values but pretty close to the edge, showing that the standard error is high enough to shift the test statistic out so far even with the exact same mean.

```{r}
plot(x, dt(x, df=9), type="l", col="blue", ylab="Probability")
abline(v=qt(0.025, 9), col="red")
abline(v=qt(0.975, 9), col="red")
t <- (mean(ds) - 1.8)/se
abline(v=t)
t
```

#### **Part e**: p-value ends up being around 0.11 which is higher than our alpha value of 0.05. We fail to reject the null hypothesis and conclude that there is no major statistical difference between advertised download time and the actual download times.

```{r}
2 * pt(t, 9, lower.tail = F)
t.test(ds, mu=1.8, alternative='two.sided', conf.level=0.9)
```

#### **Part f**: 90% confidence interval goes from around 1.80 to 2.10.

```{r}
mean(ds) + qt(0.05, 9)*se
mean(ds) + qt(0.95, 9)*se
```

## Problem 2

#### $H_0:\mu_1=\mu_2, H_A:\mu_1\neq\mu_2$

```{r}
bfast <- c(14.5, 15.9, 17.2, 16.1, 19.2, 17.9, 18.4, 15.1, 18.9, 20.6)
cntl <- c(20.0, 18.5, 19.5, 19.4, 16.9, 18.3, 21.9, 15.7, 17.4, 21.5, 20.7)
```

#### P-value is 0.06177, which is less than the 0.1 significance value.

```{r}
t.test(bfast, cntl)
```

#### Conclusion: We would reject the null hypothesis, meaning that there is a statistical difference between test takers based on whether or not they ate a good breakfast.

<br>

# **Master**

## Problem 3

#### **Part a**: 90% confidence interval ranges from around 606.61 to 916.39.

```{r}
se <- 340.6/sqrt(15)
761.5 + qt(0.05, df=14) * se
761.5 + qt(0.95, df=14) * se
```

#### **Part b**: 1000 is not even included in the 95% interval so I would say it is unreasonable to make that conclusion.

```{r}
761.5 + qt(0.025, df=14) * se
761.5 + qt(0.975, df=14) * se
```

#### **Part c**: $\bar{X}$ would have to be increased to 845.1059 to barely change the conclusion.

#### $\bar{X}+qt(0.95,14) \cdot se\approx\bar{X}+154.89\rightarrow\bar{X}\geq845.11$

```{r}
1000 - qt(0.95, df=14) * se
845.1059 + qt(0.95, df=14) * se
```

## Problem 4

#### **Part a**:

#### $H_0:\mu_{diff}=0, H_A:\mu_{diff}\neq0$

```{r}
solar <-c (31.72, 26.33, 29.08, 29.24, 28.29, 28.78, 27.73, 28.44, 28.98, 33.53, 27.76, 28.01, 24.89, 26.42)
natgas <- c(34.02, 43.10, 32.22, 37.63, 31.04, 37.85, 25.02, 28.23, 35.67, 33.50, 27.19, 36.20, 33.12, 30.25)
```

#### P-value is around 0.0048, which is less than the 0.05 significance value.

```{r}
t.test(solar, natgas, pair=T, conf.level=0.99)
```

#### Conclusion: We would reject the null hypothesis, meaning that there is a statistical difference between LCOE for solar compared to natural gas as energy sources.

#### **Part b**: 99% confidence interval ranges from around -8.87 to -0.53.

```{r}
diff <- solar - natgas
se <- sd(diff)/sqrt(14)
1 - 0.01/2
mean(diff) + qt(0.005, 13) * se
mean(diff) + qt(0.995, 13) * se
```

# **Wizard**

## Problem 5

```{r}
norm.test <- function(x, alternative = c("two.sided", "less", "more"), mu = 0, sigma = 1, alpha = 0.05, conf.level = 0.95) {
  x.bar <- mean(x)
  print(paste("x.bar:", round(x.bar, 3)))
  se <- sigma/sqrt(length(x))
  print(paste("Standard error:", round(se, 3)))
  if (alternative == "two.sided"){
    print(paste("Critical values:", round(qnorm(alpha/2, mu, se), 3), "to", round(qnorm(1 - alpha/2, mu, se), 3)))
    pval <- 2*pnorm(x.bar, mu, se)
    if (pval > 1){
      pval <- 2*pnorm(x.bar, mu, se, lower.tail=T)
    }
    print(paste("p-value:", round(pval, 3)))
  } else if (alternative == "less") {
    print(paste("Critical value:", round(qnorm(alpha, mu, se), 3)))
    print(paste("p-value:", round(pnorm(x.bar, mu, se, lower.tail=F), 3)))
  } else {
    print(paste("Critical value:", round(qnorm(1 - alpha, mu, se), 3)))
    print(paste("p-value:", round(pnorm(x.bar, mu, se), 3)))
  }
  rem <- 1 - conf.level
  print(paste(conf.level * 100, "% confidence interval:", round(x.bar + qnorm(rem / 2, 0, 1) * se, 3), "to", round(x.bar + qnorm(1 - alpha/2, 0, 1) * se, 3)))
}
```

```{r}
smu <- c(7.28, 5.84, 5.11, 5.24, 4.94, 7.01, 4.17, 8.02, 4.88, 8.83, 5.40, 6.55, 7.87, 7.39, 5.51, 9.29, 5.10, 7.38, 7.33, 10.21, 8.35)
norm.test(smu, mu=7.3, sigma=1.33, alternative = "two.sided")
```
