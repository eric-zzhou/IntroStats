---
title: "Assignment 13"
author: "Eric Zhou"
date: "2023-03-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# **Apprentice**

## Problem 1

```{r}
hw <- c(9.9, 8.9, 11.5, 9.0, 10.0, 8.5, 7.5, 9.4, 10.5, 8.5, 10.4, 8.9, 9.3, 10.0, 8.9, 8.4, 8.4, 11.0, 8.1, 8.0, 11.1, 9.3, 10.3, 8.8, 8.5, 7.7, 8.2, 8.0, 9.0, 8.3, 14.2, 10.0,  9.9, 7.5, 11.3, 9.1, 10.2, 6.9, 8.5, 8.6)
x.bar = mean(hw)
x.bar
```

#### **Part a**: $H_0: \mu = 8.75$, $H_A: \mu\neq8.75$

#### **Part b**: The null distribution is a normal distribution. The random variable is $\bar{X}$, the average hours of studying per week of a set of data assuming true mean of 8.75 and standard error of around 0.237. The distribution shows the likelihood of different test mean values.

```{r}
se <- 1.5/sqrt(40)
se
```

#### **Part c**: Critical values are 8.29 and 9.21.

```{r}
qnorm(0.025, 8.75, se)
qnorm(0.975, 8.75, se)
```

#### **Part d**: X bar, $\bar{X}$. It's also just the average of the test set, being 9.2625 for the data collected.

#### **Part e**:

```{r}
x <- seq(8.75 - 3 * se, 8.75 + 3 * se, by=0.001)
y <- dnorm(x, 8.75, se)
plot(x, y, type="l", xlab = "x-bar", ylab="probability")
abline(v=qnorm(0.025, 8.75, se), col="red")
abline(v=qnorm(0.975, 8.75, se), col="red")
abline(v=x.bar, col="blue")
```

#### **Part f**: P-value of 0.03

```{r}
2*pnorm(x.bar, 8.75, se, lower.tail = F)
```

#### **Part g**: We would reject the null hypothesis with a $\bar{X}$ value above the higher critical value and a p-value below our $\alpha$ value of 0.05. This means that there is a statistically significant difference between average EPS student study time vs that of the average public school student.

## Problem 2

#### **Part a**: The 95% confidence range goes from 8.797 to 9.727

```{r}
x.bar - 1.96 * se
x.bar + 1.96 * se
```

#### **Part b**: The 95% confidence range does not include the true mean which reflects that the public school statistics on homework most likely is not be an accurate representation for EPS.

<br>

## Problem 3

#### **Part a**: 5% since the top and bottom 2.5% are rejected even though they are possible.

#### **Part b**: $\beta\approx0.001$. The area that includes Type II Error is the area under the curve of the blue that is within the 2 red critical values. Statistical power is around 0.999.

```{r}
se <- 21/sqrt(18)
x <- seq(750 - 3 * se, 775 + 3 * se, by=0.001)
y <- dnorm(x, 750, se)
plot(x, y, type="l", xlab="x-bar", ylab="probability")
abline(v=qnorm(0.025, 750, se), col="red")
abline(v=qnorm(0.975, 750, se), col="red")
y2 <- dnorm(x, 775, se)
lines(x, y2, col="blue")

1 - pnorm(qnorm(0.975, 750, se), 775, se)- pnorm(qnorm(0.025, 750, se), 775, se)
pnorm(qnorm(0.975, 750, se), 775, se)- pnorm(qnorm(0.025, 750, se), 775, se)
```

#### **Part c**: Type I would stay the same, Type II decreases to 5.3e-11.

```{r}
se <- 21/sqrt(50)
pnorm(qnorm(0.975, 750, se), 775, se)- pnorm(qnorm(0.025, 750, se), 775, se)
```

<br>

# **Master**

## Problem 4

```{r}
scores <- c(90.75, 92.25, 87.5, 82.75, 88.25, 91.5, 88.0, 82.5, 87.25, 79.25, 74.5, 88.25, 90.0, 89.5, 91.5, 90.75, 90.25, 75.25, 89.5, 87.25, 90.0, 87.0, 82.5, 99.25, 93.25, 90.5, 89.0, 99.0, 97.5, 90.25, 92.5, 87.0, 79.5, 89.75, 91.5)

```

#### **Part a**: $H_0: \mu \leq 87.5$, $H_A: \mu>87.5$

#### **Part b**: Standard error is around 0.52.

```{r}
se <- 3.1/sqrt(35)
se
```

#### **Part c**:

```{r}
x <- seq(from=87.5-3*se, to=87.5+3*se, by=0.01)
y <- dnorm(x, 87.5, se)
plot(x, y, type="l", xlab="bar X", ylab="probability")
abline(v=qnorm(0.95, 87.5, se), col="red")
```

#### **Part d**: Test statistic is above the critical value so we would reject the null hypothesis. This means that there is a statistical difference that shows complete breakfasts do positively impact test scores.

```{r}
qnorm(0.95, 87.5, se)
x.bar <- mean(scores)
x.bar
```

#### **Part e**: P-value is around 0.0371 which is below the $\alpha$ value.

```{r}
pnorm(x.bar, 87.5, se, lower.tail=F)
```

#### **Part f**: 90% confidence interval goes from about 87.57 to 89.30

```{r}
x.bar - 1.65 * se
x.bar + 1.65 * se
```

<br>

# **Wizard**

## Problem 5: Not sure if I did this correctly, especially the standard error calculation, but it seems that the required sample size is 1041.

```{r}
for (i in 10:10000){
  se <- sqrt(0.55*(1-0.55)/i)
  beta <- pnorm(qnorm(0.975, 0.5, se), 0.55, se) - pnorm(qnorm(0.025, 0.5, se), 0.55, se)
  if (beta <= 0.1){
    print(i)
    print(beta)
    break
  }
}
```

```{r}
2 * pnorm(18.1, 17.5, 0.48, lower.tail=F)
(18.1 - 17.5)/0.48
2 * pnorm(1.25, 0, 1, lower.tail=F)
```
